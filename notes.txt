TODO:
* Need to test all the failure conditions